import cv2 
import numpy as np 
from numpy.linalg import norm
import insightface

def cosim(v1, v2):
    """
    Computes the cosine similarity between two NumPy arrays.
    """
    v1_np = np.array(v1)
    v2_np = np.array(v2)
    
    dot_product = np.dot(v1_np, v2_np)
    magnitude_v1 = norm(v1_np)
    magnitude_v2 = norm(v2_np)

    if magnitude_v1 == 0 or magnitude_v2 == 0:
        return 0

    return dot_product / (magnitude_v1 * magnitude_v2)


andreas1 = cv2.imread("andreas1.jpg")
andreas2 = cv2.imread("andreas2.jpg")
armen1 = cv2.imread("armen1.jpg")
armen2 = cv2.imread("armen2.jpg")

model = insightface.app.FaceAnalysis()
model.prepare(ctx_id=0)

andreas1_emb = model.get(andreas1)[0]['embedding']
andreas2_emb = model.get(andreas2)[0]['embedding']
armen1_emb = model.get(armen1)[0]['embedding']
armen2_emb = model.get(armen2)[0]['embedding']

andreas_emb_web = np.array([1.625651,1.0282323,0.990801,0.41132218,0.78640157,-0.09783886,1.3234386,0.25962776,-0.77839863,-0.19318822,-1.1273794,-0.6692055,-0.9721483,-0.18904275,1.1460073,1.2491746,-1.9766663,-0.5797094,0.26399696,-1.5415658,1.1634437,-0.8956176,1.483889,-0.71893144,2.4037478,0.5056052,-1.2246886,-1.3173836,-0.6914867,0.54879975,-0.62249684,-1.6104634,1.973353,0.18775989,-0.25351,1.7236539,0.47211182,0.2422925,-0.34298483,0.6578391,-1.7697893,-1.9008657,0.6857923,1.0190005,-0.03051421,0.9071939,-1.1173419,-1.0904139,0.004216537,0.26898736,-1.3725916,1.4607021,0.10236716,-0.64418113,-0.82361317,0.823002,0.09167111,-1.0565833,-1.8549101,-0.06363949,-0.411877,0.10878017,-0.862143,-1.3728857,-1.0001523,-0.24166651,-0.39725447,-0.7293065,-1.7562962,-0.9301595,-0.37219322,1.2772942,0.99237436,0.24166027,0.018101215,0.21855804,-1.2062066,1.6544489,-0.383421,0.25468355,-0.65783733,1.6469253,-0.8799652,0.42188686,0.66567415,0.33904022,0.5543165,0.1276268,-1.003841,-1.2515448,-1.2722764,0.6481242,0.96053743,-1.4610806,1.9036782,0.21688992,-2.422367,-0.29580712,-0.18242756,-0.6613202,1.1319774,-0.28043872,-0.9387691,0.9413981,2.9581113,0.7271106,0.3665382,-0.15698472,-0.83969337,-2.4847646,-0.54801345,-0.5273683,-0.19059244,0.0025892854,0.46988535,0.5460369,-1.9706447,2.2125833,-1.5006356,-1.3498746,0.07842313,0.42928195,-0.124607906,-1.481461,2.2192838,0.67729616,1.0909121,1.071264,0.65577096,0.20223144,-0.393968,1.720936,1.3136308,-0.8677728,0.6017844,-1.2189502,-1.2559857,0.6690533,-0.6404763,0.47589314,0.26276663,-0.43275237,-0.6601744,0.28814304,0.38225904,-0.48625094,-0.2634119,1.314018,-0.64433956,-2.2157326,-1.1397249,0.31581938,-1.0096622,0.5415001,-0.8771416,-1.3992889,0.2869309,-1.0936861,0.77205896,1.5250429,0.3259264,-0.47225094,-0.7748373,-1.2151477,-0.89478564,0.8553133,1.6523272,1.8568203,0.17948398,1.6376584,0.28153706,-0.22579126,-1.7877045,0.6356788,-1.2684165,0.2923852,-1.9678422,-0.7022393,0.88015985,3.521977,0.3919704,-1.0198598,0.46025378,-0.43089634,0.0813942,0.67805,-0.9185339,-1.9805233,0.27093562,0.16405109,-1.5130181,-0.64887506,0.6170844,-1.2531852,-0.4233135,-0.987696,2.3481774,1.5110539,-0.82515454,-1.0709959,1.667317,-1.4080522,0.7847395,-0.2643003,0.1650815,1.9998885,-1.155476,0.8447369,1.3781126,-0.42866364,1.2281436,-0.17033167,-0.021598026,0.44737288,-0.20630652,1.3136907,0.94019234,-0.92685616,1.9016387,-0.28193972,-0.39958796,-0.59594506,0.6382168,0.74415153,1.1295644,-1.5509479,0.01345475,0.88523567,0.0992752,0.36550868,0.6241338,0.015573189,0.049401633,-0.09741843,0.33492157,-0.5353584,-0.917379,0.001837872,-1.1935761,1.2002618,0.16853222,-2.1391273,1.4587471,1.2284391,-0.6731464,-1.916027,-0.1899382,1.6679375,2.4038541,-1.8818455,-0.71707,-1.4734342,-0.1591134,-1.1694385,1.492569,-2.2978294,-1.0660908,-1.2647101,-0.61531377,-0.9217696,0.60391814,-0.15712678,0.36170906,-0.072332025,-2.4468465,1.0005047,1.4554939,0.85705996,-0.9457562,-0.8637651,-0.80599934,0.9878908,0.13013922,1.4641325,0.8022676,-1.4456753,-1.6739413,0.51706785,0.120690025,-0.6558987,-1.631056,-0.86927754,-0.88883823,-1.6490586,-1.5018649,0.71066433,-0.9853193,2.0163994,0.89818895,1.1455804,1.6688362,0.42305934,-0.48225975,-2.1951523,1.5022352,1.1735909,-0.6296159,-1.5611241,-1.7109333,-0.95754737,-0.45487088,0.6075269,-0.6998829,0.67054254,-1.6751553,0.017167144,1.9721917,-2.609523,0.26945165,-0.46480775,1.6683192,-1.0091425,-1.7096378,-0.16735774,-0.22153334,0.10701661,0.64712596,-0.14354928,-0.5323644,0.9735066,1.6007783,-1.8261522,-0.9655818,0.07977852,1.1316352,-0.25859132,-0.48882556,1.0224946,0.28561738,0.24307466,-2.1028316,0.112556525,0.040754154,0.14117269,-0.2813164,0.39376247,-1.4563885,1.0851697,-0.35514942,-0.44168267,0.67508495,1.17153,-0.49974886,0.51244736,0.012535906,2.3737226,0.5774396,-1.6539254,0.7357888,1.4788618,-0.514981,-1.062678,-0.13173236,0.10684751,-0.96329534,0.28352472,-1.3849183,-1.0403694,1.2822427,-0.08097198,0.09136228,0.089265965,-0.13854782,-0.7491849,1.5809346,-0.43985525,-0.9553239,-0.4454649,0.9005574,-0.12455319,-0.80999315,0.1350087,-2.1524634,-0.43175572,-1.8612663,0.2414281,-1.8467929,0.070991166,-0.047231838,0.26185504,-1.4798601,0.8001904,-1.3263084,-1.9850425,1.6479166,-1.4881909,0.13777718,0.9690238,-0.6407904,1.7852587,-0.5768176,0.4581871,-0.34944814,-1.1582911,0.11005806,0.47590843,0.4063887,2.4351285,-2.4140244,-0.27540454,0.107871234,-0.4820056,1.2227432,-0.71985334,0.787777,-1.3164173,0.9076275,-0.42205507,1.0363991,-3.8079765,1.7106149,-0.05140999,0.018404275,-0.5980359,0.39540577,0.16820464,-0.69911325,1.0701195,2.3421535,0.350519,1.0574449,2.51017,1.2984738,1.6543041,0.43809378,-2.428433,0.006561652,1.9123001,0.789181,0.37042356,-0.5924538,0.74377227,-0.2531551,0.40841582,-0.62322307,1.5347854,1.1426209,0.07726669,0.3419236,2.5721915,1.3736783,0.3467952,0.06871216,1.0972246,0.8244538,0.8629042,-1.0647864,-3.0366585,0.106430784,-0.9452301,0.25201792,-1.1852407,0.9500041,1.3089832,-0.31164327,0.9492893,-1.2312523,0.09507431,-0.040277775,0.49922296,-0.07268609,-0.74714583,-0.49546415,1.3653823,-2.704459,-1.2628146,0.8808434,-1.6993643,-0.22204074,-0.19741137,-0.17301306,0.036613353,-0.4663977,-0.62225604,0.7378634,-1.4669027,-0.647038,-0.45575282,-2.104945,-0.97934276,0.029419284,0.46463346,-0.22561258,-1.2554176,-0.048265144,-2.4208994,0.45032918,2.075027,0.14178896,1.4494865,-0.41140848,-0.012643233,-0.3538857,0.12328121,-0.34570396,0.9145849,-0.196513,1.0137442,-0.37991315,0.4472779,0.15354428,0.31169885,-0.8672515,-0.66585076,-1.2175467,0.12213074,0.45951876,-0.35224524,0.5379596,-1.3397363,-0.8637816,0.84553725])


print("vector length: ", len(andreas1_emb))
print("similarity scores:")
print(" andreas1 -> andreas_web: ", cosim(andreas1_emb, andreas_emb_web))
print(" andreas1 -> andreas2: ", cosim(andreas1_emb, andreas2_emb))
print(" armen1   -> armen2:   ", cosim(armen1_emb, armen2_emb))
print(" andreas1 -> armen1:   ", cosim(andreas1_emb, armen1_emb))
print(" andreas1 -> armen2:   ", cosim(andreas1_emb, armen2_emb))
print(" andreas2 -> armen1:   ", cosim(andreas2_emb, armen1_emb))
print(" andreas2 -> armen2:   ", cosim(andreas2_emb, armen2_emb))

